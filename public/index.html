<!DOCTYPE html>
<body>
	<h1> Log </h1>
	<div id="log">
	</div>
	<ul id="choices">
	</ul>
	<script>
		var currentLine = 1;

		async function update(event){
			console.log("Getting line", currentLine)
			let list = document.getElementById("log")

			let index = event.data
			let text = await fetch(`/update/log?line=${currentLine}`)
				.then((response) => response.text())
				.then((text) => text)

			if ( text != undefined ) {
				let newLine = document.createElement('p')

				newLine.id = `line ${currentLine}`
				newLine.innerText = text

				console.log(currentLine, ": ", text)

				list.append(newLine)

				currentLine += 1
			}
		};

		const evnt = new EventSource('/stream')
		evnt.addEventListener('New content', update)
	</script>
</body>
